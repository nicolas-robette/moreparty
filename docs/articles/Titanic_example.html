<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>[en] An example of recursive partitioning with Titanic data • moreparty</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="[en] An example of recursive partitioning with Titanic data">
<meta property="og:description" content="moreparty">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">moreparty</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/moreparty.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Titanic_example.html">[en] An example of recursive partitioning with Titanic data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Titanic_example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>[en] An example of recursive partitioning with Titanic data</h1>
                        <h4 class="author">Nicolas Robette</h4>
            
            <h4 class="date">2021-01-02</h4>
      
      
      <div class="hidden name"><code>Titanic_example.Rmd</code></div>

    </div>

    
    
<div id="first-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#first-steps" class="anchor"></a>First steps</h2>
<p>First, the necessary packages are loaded into memory.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>  <span class="co"># data management</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span>  <span class="co"># confusion matrix</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://party.R-forge.R-project.org">party</a></span><span class="op">)</span>  <span class="co"># conditional inference random forests and trees</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://partykit.r-forge.r-project.org/partykit/">partykit</a></span><span class="op">)</span>  <span class="co"># conditional inference trees</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://expasy.org/tools/pROC/">pROC</a></span><span class="op">)</span>  <span class="co"># ROC curves</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">measures</span><span class="op">)</span>  <span class="co"># performance measures</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">varImp</span><span class="op">)</span>  <span class="co"># variable importance</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bgreenwell.github.io/pdp/index.html">pdp</a></span><span class="op">)</span>  <span class="co"># partial dependence</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/koalaverse/vip/">vip</a></span><span class="op">)</span>  <span class="co"># measure of interactions</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">moreparty</span><span class="op">)</span>  <span class="co"># surrogate trees, accumulated local effects, etc.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>  <span class="co"># color palettes</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://nicolas.robette.free.fr/outils_eng.html">GDAtools</a></span><span class="op">)</span>  <span class="co"># bivariate analysis</span></code></pre></div>
<p>Now, we then import <code>titanic</code> data set from <a href="https://cran.r-project.org/package=moreparty"><code>moreparty</code></a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">)</span></code></pre></div>
<pre><code>tibble [1,309 × 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Survived: Factor w/ 2 levels "No","Yes": 2 2 1 1 1 2 2 1 2 1 ...
 $ Sex     : Factor w/ 2 levels "female","male": 1 2 1 2 1 2 1 2 1 2 ...
 $ Pclass  : Factor w/ 3 levels "1st","2nd","3rd": 1 1 1 1 1 1 1 1 1 1 ...
 $ Age     : num [1:1309] 29 0.917 2 30 25 ...
 $ Embarked: Factor w/ 3 levels "Cherbourg","Queenstown",..: 3 3 3 3 3 3 3 3 3 1 ...</code></pre>
<p>We have 1309 cases, one categorical explained variable, <code>Survived</code>, which codes whether or not an individual survived the shipwreck, and four explanatory variables (three categorical and one continuous): gender, age, passenger class, and port of embarkation. The distribution of the variables is examined.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">)</span></code></pre></div>
<pre><code> Survived      Sex      Pclass         Age                 Embarked  
 No :809   female:466   1st:323   Min.   : 0.1667   Cherbourg  :270  
 Yes:500   male  :843   2nd:277   1st Qu.:21.0000   Queenstown :123  
                        3rd:709   Median :28.0000   Southampton:914  
                                  Mean   :29.8811   NA's       :  2  
                                  3rd Qu.:39.0000                    
                                  Max.   :80.0000                    
                                  NA's   :263                        </code></pre>
<p>The distribution of the explained variable is not balanced, as survival is largely in the minority. In addition, some explanatory variables have missing values, in particular <code>Age</code>.</p>
<p>We examine the bivariate statistical relationships between the variables.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/BivariateAssoc.html">BivariateAssoc</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, <span class="va">titanic</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>$YX
  variable measure assoc p.value   criterion
1      Sex  cramer 0.527 0.00000 0.000000000
2   Pclass  cramer 0.313 0.00000 0.000000000
3 Embarked  cramer 0.184 0.00000 0.000000001
4      Age    eta2 0.002 0.26069 0.302040642

$XX
  variable1 variable2 measure assoc p.value    criterion
1    Pclass       Age    eta2 0.170 0.00000 0.0000000000
2    Pclass  Embarked  cramer 0.280 0.00000 0.0000000000
3       Sex    Pclass  cramer 0.125 0.00004 0.0000378611
4       Sex  Embarked  cramer 0.122 0.00006 0.0000563134
5       Age  Embarked    eta2 0.006 0.01789 0.0180491352
6       Sex       Age    eta2 0.003 0.03964 0.0404512887</code></pre>
<p>Survival is primarily associated with gender, secondarily with the passenger class. The explanatory variables are weakly related to each other.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/GDAtools/man/catdesc.html">catdesc</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, <span class="va">titanic</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, min.phi<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<pre><code>$variables
  variable measure assoc p.value   criterion
1      Sex  cramer 0.527 0.00000 0.000000000
2   Pclass  cramer 0.313 0.00000 0.000000000
3 Embarked  cramer 0.184 0.00000 0.000000001
4      Age    eta2 0.002 0.26069 0.302040642

$bylevel
$bylevel$No
$bylevel$No$categories
            categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
2             Sex.male            0.809            0.843           0.644  0.527
5           Pclass.3rd            0.745            0.653           0.542  0.282
8 Embarked.Southampton            0.667            0.754           0.699  0.150
6   Embarked.Cherbourg            0.444            0.148           0.207 -0.181
3           Pclass.1st            0.381            0.152           0.247 -0.278
1           Sex.female            0.273            0.157           0.356 -0.527

$bylevel$No$continuous.var
  variables median.x.in.ycat median.x.global sd.x.in.ycat sd.x.global
1       Age               28              28     13.92254     14.4135
   corr.coef
1 0.05551252


$bylevel$Yes
$bylevel$Yes$categories
            categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
1           Sex.female            0.727            0.678           0.356  0.527
3           Pclass.1st            0.619            0.400           0.247  0.278
6   Embarked.Cherbourg            0.556            0.301           0.207  0.181
8 Embarked.Southampton            0.333            0.610           0.699 -0.150
5           Pclass.3rd            0.255            0.362           0.542 -0.282
2             Sex.male            0.191            0.322           0.644 -0.527

$bylevel$Yes$continuous.var
  variables median.x.in.ycat median.x.global sd.x.in.ycat sd.x.global
1       Age               28              28     15.06148     14.4135
    corr.coef
1 -0.05551252</code></pre>
<p>Women, first class passengers and those who boarded at Cherbourg are over-represented among the survivors. Men, 3rd class passengers and those who boarded at Southampton are over-represented among the non-survivors.</p>
<p>Random forests imply a share of randomness (via resampling and drawing of splitting variables), as well as some interpretation tools (via variable permutations). From one program run to the next, the results may therefore differ slightly. If you wish to obtain the same results systematically and to ensure reproducibility, use the <code>set.seed</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1912</span><span class="op">)</span></code></pre></div>
</div>
<div id="classification-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#classification-tree" class="anchor"></a>Classification tree</h2>
<p>In order to build a classification tree with CTree conditional inference algorithm, we use <a href="https://cran.r-project.org/package=partykit"><code>partykit</code></a> package, which allows more flexibility than <a href="https://cran.r-project.org/package=party"><code>party</code></a> package, in particular to deal with missing values.</p>
<p>The tree can be displayed in textual or graphical form.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">arbre</span> <span class="op">&lt;-</span> <span class="fu">partykit</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/partykit/man/ctree.html">ctree</a></span><span class="op">(</span><span class="va">Survived</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">titanic</span>, control<span class="op">=</span><span class="fu">partykit</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/partykit/man/ctree_control.html">ctree_control</a></span><span class="op">(</span>minbucket<span class="op">=</span><span class="fl">30</span>, maxsurrogate<span class="op">=</span><span class="cn">Inf</span>, maxdepth<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">arbre</span><span class="op">)</span></code></pre></div>
<pre><code>
Model formula:
Survived ~ Sex + Pclass + Age + Embarked

Fitted party:
[1] root
|   [2] Sex in female
|   |   [3] Pclass in 1st, 2nd
|   |   |   [4] Pclass in 1st: Yes (n = 144, err = 3.5%)
|   |   |   [5] Pclass in 2nd: Yes (n = 106, err = 11.3%)
|   |   [6] Pclass in 3rd
|   |   |   [7] Embarked in Cherbourg, Queenstown: Yes (n = 87, err = 36.8%)
|   |   |   [8] Embarked in Southampton: No (n = 129, err = 39.5%)
|   [9] Sex in male
|   |   [10] Pclass in 1st
|   |   |   [11] Age &lt;= 53: No (n = 148, err = 38.5%)
|   |   |   [12] Age &gt; 53: No (n = 31, err = 12.9%)
|   |   [13] Pclass in 2nd, 3rd
|   |   |   [14] Age &lt;= 9: No (n = 77, err = 35.1%)
|   |   |   [15] Age &gt; 9: No (n = 587, err = 12.4%)

Number of inner nodes:    7
Number of terminal nodes: 8</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">arbre</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/ctree-1.png" width="100%"></p>
<p><code>Sex</code> is the first splitting variable, <code>Pclass</code> is the second and all the explanatory variables are used in the tree.</p>
<p>The proportion of survivors varies greatly from one terminal node to another.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/partykit/man/nodeapply.html">nodeapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/partykit/man/party-coercion.html">as.simpleparty</a></span><span class="op">(</span><span class="va">arbre</span><span class="op">)</span>, ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/partykit/man/nodeids.html">nodeids</a></span><span class="op">(</span><span class="va">arbre</span>, terminal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/partykit/man/partynode.html">info_node</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">distribution</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>$`4`
   No   Yes 
0.035 0.965 

$`5`
   No   Yes 
0.113 0.887 

$`7`
   No   Yes 
0.368 0.632 

$`8`
   No   Yes 
0.605 0.395 

$`11`
   No   Yes 
0.615 0.385 

$`12`
   No   Yes 
0.871 0.129 

$`14`
   No   Yes 
0.649 0.351 

$`15`
   No   Yes 
0.876 0.124 </code></pre>
<p>Thus, 96.5% of women travelling in 1st class survive, compared with only 12.4% of men over 9 years of age travelling in 2nd or 3rd class.</p>
<p>The graphical representation can be parameterized to obtain a simpler and more readable tree.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">arbre</span>, inner_panel<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/party/man/panelfunctions.html">node_inner</a></span><span class="op">(</span><span class="va">arbre</span>,id<span class="op">=</span><span class="cn">FALSE</span>,pval<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, terminal_panel<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/party/man/panelfunctions.html">node_barplot</a></span><span class="op">(</span><span class="va">arbre</span>,id<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span>, ep_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>justmin<span class="op">=</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/ctree_plot-1.png" width="100%"></p>
<p>Note that the <a href="https://cran.r-project.org/package=ggparty"><code>ggparty</code></a> package graphically represents Ctree trees with the <code>ggplot2</code> grammar.</p>
<p>To measure the performance of the tree, the AUC is calculated, by comparing predicted and observed survival.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred_arbre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">arbre</span>, type<span class="op">=</span><span class="st">'prob'</span><span class="op">)</span><span class="op">[</span>,<span class="st">'Yes'</span><span class="op">]</span>

<span class="va">auc_arbre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/measures/man/AUC.html">AUC</a></span><span class="op">(</span><span class="va">pred_arbre</span>, <span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, positive<span class="op">=</span><span class="st">'Yes'</span><span class="op">)</span>
<span class="va">auc_arbre</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 0.838</code></pre>
<p>AUC is 0.838, which is a relatively high performance.</p>
<p>To plot the ROC curve of the model :</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, <span class="va">pred_arbre</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span>legacy.axes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span>,xend<span class="op">=</span><span class="fl">1</span>,y<span class="op">=</span><span class="fl">0</span>,yend<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"darkgrey"</span>, linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">xlab</span><span class="op">(</span><span class="st">"TFP"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ylab</span><span class="op">(</span><span class="st">"TVP"</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/roc_tree-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Other performance measures are based on the confusion matrix.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">pred_arbre</span> <span class="op">&gt;</span> <span class="fl">.5</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="va">factor</span> <span class="op">%&gt;%</span>
  <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, positive<span class="op">=</span><span class="st">'Yes'</span><span class="op">)</span></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  No Yes
       No  760 212
       Yes  49 288
                                          
               Accuracy : 0.8006          
                 95% CI : (0.7779, 0.8219)
    No Information Rate : 0.618           
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.5497          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.5760          
            Specificity : 0.9394          
         Pos Pred Value : 0.8546          
         Neg Pred Value : 0.7819          
             Prevalence : 0.3820          
         Detection Rate : 0.2200          
   Detection Prevalence : 0.2574          
      Balanced Accuracy : 0.7577          
                                          
       'Positive' Class : Yes             
                                          </code></pre>
<p>The <code>GetSplitStats</code> function allows to examine the result of the competition between covariates in the choice of splitting variables. If, for a given node, the splitting variable is significantly more associated with the explained variable than the other explanatory variables, we can think that this split is stable.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/GetSplitStats.html">GetSplitStats</a></span><span class="op">(</span><span class="va">arbre</span><span class="op">)</span></code></pre></div>
<pre><code>$`1`
                    Sex        Pclass        Age      Embarked
statistic  3.656074e+02  1.277615e+02  3.2203137  4.420789e+01
p.value    6.771232e-81  7.227818e-28  0.2606920  1.005629e-09
criterion -6.771232e-81 -7.227818e-28 -0.3020406 -1.005629e-09

$`2`
                 Pclass         Age      Embarked
statistic  1.154544e+02  7.07039686  2.433650e+01
p.value    2.549845e-25  0.02332660  1.557812e-05
criterion -2.549845e-25 -0.02360298 -1.557824e-05

$`3`
               Pclass        Age   Embarked
statistic  5.91071179  0.2003411  4.2482494
p.value    0.04447125  0.9587381  0.3174531
criterion -0.04549043 -3.1878160 -0.3819240

$`6`
                 Age     Embarked
statistic  1.7248154 12.759465580
p.value    0.3423996  0.003388277
criterion -0.4191579 -0.003394030

$`9`
                 Pclass          Age      Embarked
statistic  3.299374e+01 10.838488444 17.7107774921
p.value    2.054102e-07  0.002979392  0.0004277725
criterion -2.054103e-07 -0.002983839 -0.0004278640

$`10`
                   Age   Embarked
statistic  9.079224404  2.1938826
p.value    0.005163910  0.5562985
criterion -0.005177289 -0.8126033

$`13`
               Pclass           Age   Embarked
statistic  0.03486032  2.540589e+01  5.2715095
p.value    0.99675089  1.393491e-06  0.1999551
criterion -5.72937273 -1.393492e-06 -0.2230874</code></pre>
<p>In this case, for each of the nodes, the result of the competition is final (see <code>criterion</code>). The tree therefore appears to be stable.</p>
</div>
<div id="random-forest" class="section level2">
<h2 class="hasAnchor">
<a href="#random-forest" class="anchor"></a>Random forest</h2>
<p>Then we build a random forest with conditional inference algorithm, <code>mtry</code>=2 and <code>ntree</code>=500.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">foret</span> <span class="op">&lt;-</span> <span class="fu">party</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/party/man/cforest.html">cforest</a></span><span class="op">(</span><span class="va">Survived</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">titanic</span>, controls<span class="op">=</span><span class="fu">party</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/party/man/cforest_control.html">cforest_unbiased</a></span><span class="op">(</span>mtry<span class="op">=</span><span class="fl">2</span>,ntree<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To compare the performance of the forest to that of the tree, the predictions and then the AUC are calculated.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred_foret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">foret</span>, type<span class="op">=</span><span class="st">'prob'</span><span class="op">)</span> <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">'rbind.data.frame'</span>,<span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
              <span class="fu">select</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
              <span class="va">unlist</span>

<span class="va">auc_foret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/measures/man/AUC.html">AUC</a></span><span class="op">(</span><span class="va">pred_foret</span>, <span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, positive<span class="op">=</span><span class="st">'Yes'</span><span class="op">)</span>
<span class="va">auc_foret</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 0.879</code></pre>
<p>The performance of the forest is 0.879, therefore slightly better than that of the tree.</p>
<p>The <code>OOB=TRUE</code> option allows predictions to be made from out-of-bag observations, thus avoiding optimism bias.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred_oob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">foret</span>, type<span class="op">=</span><span class="st">'prob'</span>, OOB<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">'rbind.data.frame'</span>,<span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
              <span class="fu">select</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
              <span class="va">unlist</span>

<span class="va">auc_oob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/measures/man/AUC.html">AUC</a></span><span class="op">(</span><span class="va">pred_oob</span>, <span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, positive<span class="op">=</span><span class="st">'Yes'</span><span class="op">)</span>
<span class="va">auc_oob</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 0.847</code></pre>
<p>Calculated in this way, the performance is indeed slightly lower (0.847).</p>
</div>
<div id="surrogate-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#surrogate-tree" class="anchor"></a>Surrogate tree</h2>
<p>The so-called “surrogate tree” can be a way to synthesize a complex model.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">surro</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SurrogateTree.html">SurrogateTree</a></span><span class="op">(</span><span class="va">foret</span>, maxdepth<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="va">surro</span><span class="op">$</span><span class="va">r.squared</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 0.96</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">surro</span><span class="op">$</span><span class="va">tree</span>, inner_panel<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/party/man/panelfunctions.html">node_inner</a></span><span class="op">(</span><span class="va">surro</span><span class="op">$</span><span class="va">tree</span>,id<span class="op">=</span><span class="cn">FALSE</span>,pval<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, terminal_panel<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/party/man/panelfunctions.html">node_boxplot</a></span><span class="op">(</span><span class="va">surro</span><span class="op">$</span><span class="va">tree</span>,id<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, gp<span class="op">=</span><span class="fu">gpar</span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span>, ep_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>justmin<span class="op">=</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/surrogate-1.png" width="100%"></p>
<p>The surrogate tree reproduces here very faithfully the predictions of the random forest (R2 = 0.96). It is also very similar to the initial classification tree.</p>
</div>
<div id="variable-importance" class="section level2">
<h2 class="hasAnchor">
<a href="#variable-importance" class="anchor"></a>Variable importance</h2>
<p>To go further in the interpretation of the results, permutation variable importance is calculated (using AUC as a performance measure). Since the explanatory variables have little correlation with each other, it is not necessary to use the “conditional permutation scheme” (available with the <code>conditional=TRUE</code> option in the <code>varImpAUC</code> function).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">importance</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/varImp/man/varImpAUC.html">varImpAUC</a></span><span class="op">(</span><span class="va">foret</span><span class="op">)</span>
<span class="va">importance</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>     Sex   Pclass      Age Embarked 
  -0.213   -0.066   -0.026   -0.008 </code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggVarImp.html">ggVarImp</a></span><span class="op">(</span><span class="op">-</span><span class="va">importance</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/vimp-1.png" width="480" style="display: block; margin: auto;"></p>
<p><code>Sex</code> is the most important variable, ahead of <code>Pclass</code>, <code>Age</code> and <code>Embarked</code> (whose importance is close to zero).</p>
</div>
<div id="first-order-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#first-order-effects" class="anchor"></a>First order effects</h2>
<p>The calculation of partial dependences of all the covariates can then be performed using the <code>GetPartialData</code> function.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetPartialData.html">GetPartialData</a></span><span class="op">(</span><span class="va">foret</span>, which.class<span class="op">=</span><span class="fl">2</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">/</span><span class="fl">20</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep</span></code></pre></div>
<pre><code>        var       cat     value
1       Sex    female 0.6705362
2       Sex      male 0.2105944
3    Pclass       1st 0.5630163
4    Pclass       2nd 0.4123658
5    Pclass       3rd 0.2726452
6       Age         5 0.5535410
7       Age        14 0.4094217
8       Age        18 0.3835784
9       Age        19 0.3851776
10      Age        21 0.3849032
11      Age        22 0.3848739
12      Age        24 0.3860633
13      Age        25 0.3910394
14      Age        26 0.3897490
15      Age        28 0.3692686
16      Age        30 0.3742014
17      Age        31 0.3977995
18      Age        33 0.3602312
19      Age        36 0.3536723
20      Age        39 0.3411718
21      Age        42 0.3396432
22      Age        45 0.3421748
23      Age        50 0.3443513
24      Age        57 0.3187270
25 Embarked Cherbourg 0.4603041
 [ reached 'max' / getOption("max.print") -- omitted 2 rows ]</code></pre>
<p>They can be represented graphically.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggForestEffects.html">ggForestEffects</a></span><span class="op">(</span><span class="va">pdep</span>, vline<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pred_foret</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Probability of survival"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/pdp_plot-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The dashed line represents the average predicted probability of survival. We can see for example that the probability of survival is much higher for women or that it decreases when we go from 1st to 3rd class.</p>
<p>We’re zooming in on age to see its effect more closely. Partial dependencies are calculated for 40 quantiles of the age distribution, this high number allowing a more precise examination.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep_age</span> <span class="op">&lt;-</span> <span class="fu">pdp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pdp/man/partial.html">partial</a></span><span class="op">(</span><span class="va">foret</span>, <span class="st">'Age'</span>, which.class<span class="op">=</span><span class="fl">2</span>, prob<span class="op">=</span><span class="cn">TRUE</span>, quantiles<span class="op">=</span><span class="cn">TRUE</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">39</span><span class="op">/</span><span class="fl">40</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">pdep_age</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Age</span>, y<span class="op">=</span><span class="va">yhat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pred_foret</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">0.2</span>, linetype<span class="op">=</span><span class="st">'dashed'</span>, color<span class="op">=</span><span class="st">'black'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Probability of survival"</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/pdp_plot_age-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The probability of survival for young children is high, but drops rapidly with age. It is around the average for young adults and declines again after age 30.</p>
<p>We often limit ourselves to examining <em>average</em> survival probabilities, but we can also look at their <em>distribution</em>, in numerical form :</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetPartialData.html">GetPartialData</a></span><span class="op">(</span><span class="va">foret</span>, which.class<span class="op">=</span><span class="fl">2</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">/</span><span class="fl">20</span>, prob<span class="op">=</span><span class="cn">TRUE</span>, ice<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep_ind</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">var</span>, <span class="va">cat</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,
                                              Q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.25</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,
                                              Q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.75</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 27 x 5
# Groups:   var [4]
   var   cat    prob    Q1    Q3
   &lt;fct&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Age   14    0.409 0.137 0.596
 2 Age   18    0.384 0.12  0.568
 3 Age   19    0.385 0.124 0.567
 4 Age   21    0.385 0.131 0.562
 5 Age   22    0.385 0.124 0.576
 6 Age   24    0.386 0.139 0.572
 7 Age   25    0.391 0.167 0.556
 8 Age   26    0.39  0.16  0.556
 9 Age   28    0.369 0.136 0.512
10 Age   30    0.374 0.155 0.509
# … with 17 more rows</code></pre>
<p>Or in graphical form :</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">pdep_ind</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="va">cat</span>, group <span class="op">=</span> <span class="va">cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
         <span class="fu">geom_boxplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">var</span><span class="op">)</span>, notch<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> 
         <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">pred_foret</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">0.2</span>, linetype<span class="op">=</span><span class="st">'dashed'</span>, color<span class="op">=</span><span class="st">'black'</span><span class="op">)</span> <span class="op">+</span>
         <span class="fu">facet_grid</span><span class="op">(</span><span class="va">var</span> <span class="op">~</span> <span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, space <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> 
         <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
         <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
               panel.grid.major.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">.1</span>, color<span class="op">=</span><span class="st">"grey70"</span><span class="op">)</span>,
               legend.position <span class="op">=</span> <span class="st">"none"</span>,
               strip.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
         <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
         <span class="fu">xlab</span><span class="op">(</span><span class="st">"Probability of survival"</span><span class="op">)</span> <span class="op">+</span>
         <span class="fu">ylab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/pdp_boxplot-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The accumulated local effects (ALE) of all explanatory variables can be calculated simply with the <code>GetAleData</code> function.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ale</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetAleData.html">GetAleData</a></span><span class="op">(</span><span class="va">foret</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ale</span></code></pre></div>
<pre><code>      var    cat        value
1     Sex female  0.294845647
2     Sex   male -0.172964164
3  Pclass    3rd -0.110876498
4  Pclass    2nd  0.029704971
5  Pclass    1st  0.169489816
6     Age 0.1667  0.193010029
7     Age      5  0.152359060
8     Age     14  0.027508715
9     Age     18  0.006407634
10    Age     19  0.009102306
11    Age     21  0.009971552
12    Age     22  0.013308471
13    Age     24  0.014876852
14    Age     25  0.024807359
15    Age     26  0.022475715
16    Age     28  0.001325135
17    Age     30  0.006729842
18    Age     31  0.028375757
19    Age     33 -0.028935497
20    Age     36 -0.036513377
21    Age     39 -0.053388466
22    Age     42 -0.054525338
23    Age     45 -0.053924936
24    Age     50 -0.043628556
25    Age     57 -0.107322361
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]</code></pre>
<p>The effects are then represented graphically. These are very convergent with the partial dependences, which is not surprising given that the explanatory variables here have little correlation.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggForestEffects.html">ggForestEffects</a></span><span class="op">(</span><span class="va">ale</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/ale_plot-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="interactions" class="section level2">
<h2 class="hasAnchor">
<a href="#interactions" class="anchor"></a>Interactions</h2>
<p>We now wish to identify the main 2nd order interactions, using the algorithm of Greenwell et al (2018) available with <code>GetInteractionStrength</code> (a simple wrapper for <code>vint</code> function in <a href="https://cran.r-project.org/package=vip"><code>vip</code></a> package).</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetInteractionStrength.html">GetInteractionStrength</a></span><span class="op">(</span><span class="va">foret</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vint</span></code></pre></div>
<pre><code># A tibble: 6 x 2
  Variables       Interaction
  &lt;fct&gt;                 &lt;dbl&gt;
1 Sex*Pclass           0.330 
2 Sex*Age              0.0636
3 Pclass*Embarked      0.0508
4 Pclass*Age           0.0482
5 Age*Embarked         0.0349
6 Sex*Embarked         0.0255</code></pre>
<p>The interaction between Sex and Pclass is by far the most pronounced.</p>
<p>The main second order interactions are then studied using partial dependence, with <code>partial</code> function from <a href="https://cran.r-project.org/package=pdp"><code>pdp</code></a> package.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep_sexclass</span> <span class="op">&lt;-</span> <span class="fu">pdp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pdp/man/partial.html">partial</a></span><span class="op">(</span><span class="va">foret</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Sex'</span>,<span class="st">'Pclass'</span><span class="op">)</span>, quantiles<span class="op">=</span><span class="cn">TRUE</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">/</span><span class="fl">20</span>, which.class<span class="op">=</span><span class="fl">2L</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">pdep_sexclass</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Pclass</span>, <span class="va">yhat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/pd_plot_inter2_sexclass-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Pclass has a greater effect on women than on men. In women, it opposes the 1st and 2nd classes to the 3rd; in men, the 1st class opposes the others.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep_sexage</span> <span class="op">&lt;-</span> <span class="fu">pdp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pdp/man/partial.html">partial</a></span><span class="op">(</span><span class="va">foret</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Sex'</span>,<span class="st">'Age'</span><span class="op">)</span>, quantiles<span class="op">=</span><span class="cn">TRUE</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">/</span><span class="fl">20</span>, which.class<span class="op">=</span><span class="fl">2L</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">pdep_sexage</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Age</span>, <span class="va">yhat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/pd_plot_inter2_sexage-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Age has little effect on survival for females, while it plays a more pronounced role for males, with young boys having a higher probability of survival than adult men.</p>
<p>An interaction of order 3 using partial dependence :</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdep_sexclassage</span> <span class="op">&lt;-</span> <span class="fu">pdp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pdp/man/partial.html">partial</a></span><span class="op">(</span><span class="va">foret</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Sex'</span>,<span class="st">'Pclass'</span>,<span class="st">'Age'</span><span class="op">)</span>, quantiles<span class="op">=</span><span class="cn">TRUE</span>, probs<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">/</span><span class="fl">20</span>, which.class<span class="op">=</span><span class="fl">2L</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'tomato'</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">pdep_sexclassage</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>sexclass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">Pclass</span>,<span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                     <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Age</span>, y<span class="op">=</span><span class="va">yhat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
                       <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour<span class="op">=</span><span class="va">sexclass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
                       <span class="fu">scale_color_manual</span><span class="op">(</span>values<span class="op">=</span><span class="va">cols</span><span class="op">)</span> <span class="op">+</span>
                       <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
                       <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="http://nicolas.robette.free.fr/Docs/plot_inter3.png" width="70%" style="display: block; margin: auto;"></p>
<p>For example, we see that the age effect plays mainly for 2nd and 3rd class males.</p>
<p>Alternatively, second order interactions can be analyzed using accumulated local effects (excluding interactions between two categorical variables).</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ale_sex_age</span> <span class="op">=</span> <span class="fu"><a href="../reference/GetAleData.html">GetAleData</a></span><span class="op">(</span><span class="va">foret</span>, xnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sex"</span>,<span class="st">"Age"</span><span class="op">)</span>, order<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ale_sex_age</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">Age</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
                  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
                  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span>, color<span class="op">=</span><span class="st">'gray60'</span><span class="op">)</span> <span class="op">+</span>
                  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/ale_plot_inter2-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The additional effect of the interaction between <code>Sex</code> and <code>Age</code> (relative to the main effects of these variables) is mainly present for children: being a boy is associated with a higher probability of survival and vice versa for girls.</p>
</div>
<div id="prototypes-and-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#prototypes-and-outliers" class="anchor"></a>Prototypes and outliers</h2>
<p>The prototypes are observations that are representative of their class. The calculation is based on the proximity matrix between observations.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/party/man/cforest.html">proximity</a></span><span class="op">(</span><span class="va">foret</span><span class="op">)</span>
<span class="va">proto</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Prototypes.html">Prototypes</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, <span class="va">titanic</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">prox</span><span class="op">)</span>
<span class="va">proto</span></code></pre></div>
<pre><code>$Yes
     Sex      Pclass Age  Embarked     
[1,] "female" "1st"  "22" "Cherbourg"  
[2,] "female" "1st"  "23" "Southampton"
[3,] "female" "1st"  "24" "Southampton"
[4,] "female" "1st"  "36" "Southampton"
[5,] "female" "1st"  "30" "Southampton"

$No
     Sex    Pclass Age  Embarked     
[1,] "male" "2nd"  "30" "Southampton"
[2,] "male" "2nd"  "21" "Southampton"
[3,] "male" "1st"  "44" "Southampton"
[4,] "male" "3rd"  "23" "Southampton"
[5,] "male" "3rd"  "19" "Southampton"</code></pre>
<p>The prototypes of survivors are all adult women traveling first class. The prototypes of non-survivors are all adult males.</p>
<p>The proximity matrix also makes it possible to identify outliers.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">bind_cols</span><span class="op">(</span>pred<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">pred_foret</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">titanic</span><span class="op">)</span> <span class="op">%&gt;%</span>
         <span class="fu"><a href="../reference/Outliers.html">Outliers</a></span><span class="op">(</span><span class="va">prox</span>, <span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, <span class="va">.</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">scores</span><span class="op">)</span></code></pre></div>
<p><img src="Titanic_example_files/figure-html/outliers1-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Only a few observations have a score above 10 (the threshold suggested by Breiman).</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">arrange</span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">outliers</span>, <span class="va">Survived</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">scores</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">Survived</span><span class="op">)</span></code></pre></div>
<pre><code>$No
  rowname pred Survived    Sex Pclass Age    Embarked   scores
1     106 0.95       No female    1st  36   Cherbourg 40.88546
2     287 0.87       No female    1st  63 Southampton 40.76770
3     170 0.94       No female    1st  50   Cherbourg 40.72306
4       3 0.87       No female    1st   2 Southampton 37.66176
5       5 0.92       No female    1st  25 Southampton 35.12976
6     457 0.78       No female    2nd  60 Southampton 13.29295
7     491 0.79       No female    2nd  57 Southampton 13.19947
8     366 0.82       No female    2nd  44 Southampton 11.46811
9     446 0.87       No female    2nd  18 Southampton 11.45314
 [ reached 'max' / getOption("max.print") -- omitted 1 rows ]

$Yes
   rowname pred Survived  Sex Pclass Age    Embarked   scores
11     521 0.33      Yes male    2nd  20   Cherbourg 15.62716
12     539 0.27      Yes male    2nd  30   Cherbourg 14.88285
13     433 0.09      Yes male    2nd  62 Southampton 14.82393
14     527 0.27      Yes male    2nd  29   Cherbourg 14.50363
15     525 0.27      Yes male    2nd  NA   Cherbourg 14.24385
16     918 0.15      Yes male    3rd  39   Cherbourg 13.77525
17     493 0.62      Yes male    2nd   1   Cherbourg 13.00300
18     455 0.09      Yes male    2nd  42 Southampton 11.72386
19     504 0.10      Yes male    2nd  19 Southampton 11.63046
 [ reached 'max' / getOption("max.print") -- omitted 2 rows ]</code></pre>
<p>Outliers among survivors are women travelling in 1st or 2nd class, whose predicted probability of survival is very high. Conversely, outliers among non-survivors are males travelling in 2nd or 3rd class, whose predicted probability of survival is low.</p>
</div>
<div id="feature-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#feature-selection" class="anchor"></a>Feature selection</h2>
<p>Variable selection is of little use in this case, where there are only four explanatory variables. However, as an illustration, the “recursive feature elimination” algorithm is applied. Note that this procedure can be time consuming, even in its parallelized version (especially for the ‘ALT’ and ‘HAPF’ algorithms).</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">featsel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FeatureSelection.html">FeatureSelection</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">$</span><span class="va">Survived</span>, <span class="va">titanic</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"RFE"</span>, positive<span class="op">=</span><span class="st">"Yes"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">featsel</span><span class="op">$</span><span class="va">selection.0se</span></code></pre></div>
<pre><code>[1] "Sex"      "Pclass"   "Age"      "Embarked"</code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">featsel</span><span class="op">$</span><span class="va">selection.1se</span></code></pre></div>
<pre><code>[1] "Sex"    "Pclass"</code></pre>
<p>The algorithm suggests to keep the set of variables, or to eliminate <code>Age</code> and <code>Embarked</code> variables if one is ready to lose some performance (“1 standard error rule”).</p>
</div>
<div id="parallelization" class="section level2">
<h2 class="hasAnchor">
<a href="#parallelization" class="anchor"></a>Parallelization</h2>
<p><a href="https://cran.r-project.org/package=moreparty"><code>moreparty</code></a> package provides parallelized versions of <code>cforest</code>, <code>varImp</code> and <code>varImpAUC</code> functions, to save computation time. For example, to parallelize the computation of variable importance :</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">doParallel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span>cores<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/fastvarImpAUC.html">fastvarImpAUC</a></span><span class="op">(</span><span class="va">foret</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">stopImplicitCluster</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>       Sex     Pclass        Age   Embarked 
0.23524608 0.07358493 0.02974304 0.01101097 </code></pre>
<p>Parallelization is also an option for many of the functions we have used here.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/nicolas-robette">Nicolas Robette</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
